# Introduction
This code will do the math for corrective contributions. A typical situation may sound like the following:
A 401(k) participant named George elects to have $300 withheld from his paycheck and placed in his 401(k) every two weeks. However, his employer's payroll system had a
error - which caused the $300 to be withdrawn from his 07/14/23 pay but not deposited into his 401(k) account. It is now 08/20/23, and George's employer has discovered this error. George's employer immediately deposits $300 into George's 401(k) account to account for the mistake. However, George's portfolio has gone up about 5.8% in the time period between 07/14/23 and 08/20/23. We need to calculate the additional amount that George's employer should deposit to make him whole.

# Installation
Aside from the native python libraries - you will need [pandas](https://pypi.org/project/pandas/) and [docx](https://pypi.org/project/python-docx/).

# Process
The process to use will involve the following:
1. Make a copy of the Corrective Contributions .ipynb template, along with the Funcs.py python file and place them in the same folder together. 
2. Create an excel sheet which contains your information, using the Data Import Template.xlsx file as a guide on how to format your information. Once you have created the sheet (note that the column names and information should exactly match the Data Import Template.xlsx), convert the excel file to .csv - which will allow you to easily read it into the .ipynb file.
3. Run the cells in the .ipynb file in a jupyter notebook (Google Collab works too). Usually, the input is 1 csv file and the output is 1-2 excel files and 1-2 word document files - though this depends on the circumstances of the case. To view an example, see the example folder.

# Summary
### Pulling in Data from SQL
The information was originally in .txt files - which were converted to SQL using a seperate script. Now that the information is stored in a SQL database, the code can take in a starting year, ending year, and employer number to generate quarterly return amounts for the dates in question. 
### Manual Rate Entry & Manual Adjustments
This allows you to add any manual adjustments to the quarterly returns generated by the code. 
### Main Calculations
This is where the bulk of the calculations are done. The final number calculated is the investment earnings for each row of data. Steps are taken depending on whether it is EE (Employee) money only or if the case invovled EE + ER (Employee + Employer) money, as well as if the investment earnings are just positive, just negative or contain both positive and negative quantities (all 3 of these scenarios are treated slightly differently). 
### Positive/Negative Procedure & Seperation
Similar to what was mentioned previously, different steps are taken depending on which of the 3 scenarios outlined above (in the Main Calculations note), the case falls into.
### Letter Generation
Here, the letter(s) are generated based on items entered/calculated previously. There is also an option to manually override some of the values with other values, if desired.

# Specific Abbreviations Used
* EE = Employee
* ER = Employer
* Pay Date = The date funds were supposed to have been deposited into EE’s account
* VTD Date = The actual deposit date into EE’s account
* VTD will always be after the Pay Date (or we wouldn’t have a corrective contribution case)
